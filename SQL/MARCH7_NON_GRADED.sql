USE THEDB;
DROP TABLE EMPDB;
CREATE TABLE EMPDB(
    EMPID VARCHAR(255),
    EMP_NAME varchar(255),
    SALARY INT,
    DEPARTMENT_ID varchar(255),
    MANAGER_ID varchar(255)
);

INSERT INTO EMPDB
VALUES ('E1', 'BHANU', 600000, 'D1','M1'),
	('E2', 'THY KIYO', 600000, 'D1','M1'),
	('E3', 'VAMSI', 200000, 'D2','M2'),
	('E4', 'SARAN', 650000, 'D3','M3'),
	('E5', 'AJIN', 70000, 'D2','M2');
SELECT * FROM EMPDB;

CREATE TABLE DEPTDB(
	DEPT_ID VARCHAR(255),
    DEPT_NAME VARCHAR(255)
);

INSERT INTO DEPTDB
VALUES ('D1','R&D'),
		('D2','SALES'),
        ('D3', 'HR'),
        ('D4','DEVELOPMENT'),
        ('D5','COMUNICATION');
SELECT * FROM DEPTDB;

CREATE TABLE MANAGER(
	MANAGER_ID VARCHAR(255),
    MANAGER_NAME VARCHAR(255),
    DEPT_ID VARCHAR(255)
);
INSERT INTO MANAGER 
VALUES ('M1','MAHAD','D1'),
		('M2','SAIYAM','D2'),
        ('M3','KIRTHI','D3'),
        ('M4', 'SHREYA','D4'),
        ('M5','SHILPI','D5');
SELECT * FROM MANAGER;

CREATE TABLE PROJECT (
		PROJECT_ID VARCHAR(20),
        PROJECT_NAME VARCHAR(30),
        TEAM_MEMBER_ID VARCHAR(10));
INSERT INTO PROJECT 
VALUES ('P1','DATA MIGRATION', 'E1'),
		('P1','DATA MIGRATION', 'M2'),
        ('P1','DATA MIGRATION', 'E2'),
        ('P2','ETL TOOL', 'E3'),
        ('P2','ETL TOOL', 'M1');
        
SELECT  * FROM PROJECT;
SELECT  * FROM EMPDB;
SELECT  * FROM MANAGER;
SELECT  * FROM DEPTDB;

-- 2 FETCH EMP NAME AND DEPT NAME THEY ARE WORKING FOR

SELECT EMP.EMP_NAME, DEP.DEPT_NAME FROM empdb emp
JOIN DEPTDB DEP
ON DEP.DEPT_ID = EMP.DEPARTMENT_ID;

-- 3 FETCH ALL EMP NAME AND DEPT NAME THEY ARE WORKING FOR
SELECT EMP.EMP_NAME, DEP.DEPT_NAME FROM empdb emp
LEFT OUTER JOIN DEPTDB DEP
ON DEP.DEPT_ID = EMP.DEPARTMENT_ID;

-- 4. FETCH THE EMP NAME AND ALL DEPT NAME THEY ARE WORKING FOR
SELECT EMP.EMP_NAME, DEP.DEPT_NAME FROM empdb emp
RIGHT OUTER JOIN DEPTDB DEP
ON DEP.DEPT_ID = EMP.DEPARTMENT_ID;

-- 5 FETCH ALL EMP NAME AND ALL DEPT NAME THEY ARE WORKING FOR
SELECT EMP.EMP_NAME, DEP.DEPT_NAME FROM empdb emp
LEFT OUTER JOIN DEPTDB DEP
ON DEP.DEPT_ID = EMP.DEPARTMENT_ID
UNION
SELECT EMP.EMP_NAME, DEP.DEPT_NAME FROM empdb emp
RIGHT OUTER JOIN DEPTDB DEP
ON DEP.DEPT_ID = EMP.DEPARTMENT_ID;

-- 6. FETCH DETAILS OF ALL EMP THEIR MANAGER THEIR DEPARTMENT AND THE PROJECTS THEY WORK ON.

SELECT EMP.EMP_NAME, MAN.MANAGER_NAME , DEP.DEPT_NAME , PRO.PROJECT_NAME
FROM empdb EMP
LEFT OUTER JOIN MANAGER MAN
ON MAN.MANAGER_ID = EMP.MANAGER_ID
LEFT OUTER JOIN DEPTDB DEP
ON DEP.DEPT_ID = EMP.DEPARTMENT_ID
LEFT OUTER JOIN PROJECT PRO
ON PRO.TEAM_MEMBER_ID=EMP.EMPID;

-- 7. FETCH DETAILS OF ONLY THE EMP THEIR MANAGER THEIR DEPARTMENT AND THE PROJECTS THEY WORK ON.
SELECT EMP.EMP_NAME, MAN.MANAGER_NAME , DEP.DEPT_NAME , PRO.PROJECT_NAME
FROM empdb EMP
JOIN MANAGER MAN
ON MAN.MANAGER_ID = EMP.MANAGER_ID
JOIN DEPTDB DEP
ON DEP.DEPT_ID = EMP.DEPARTMENT_ID
JOIN PROJECT PRO
ON PRO.TEAM_MEMBER_ID=EMP.EMPID;







